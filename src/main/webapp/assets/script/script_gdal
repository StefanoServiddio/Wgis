#!/bin/bash

echo "eseguo georeferenziazione gdal_translate"
DIR="/home/stefano/Immagini";
DIR2="/home/stefano/workspace/Wgis/src/main/webapp/assets/img";
File1="$DIR/allertaOggiEdit.jpg";

echo "$File1"
if [ -e "$File1"]
then
	echo "il file allertaOggi.jpg esiste"
	ls -l 
else
	echo "il file non esiste"
fi

echo "Ã¨ necessario assegnare un sistema di riferimento EPSG:3857 all'immagine acquisita"

gdal_translate -of GTiff -a_srs EPSG:3857 -gcp 46.2484 129.362 737802 5.63856e+06 -gcp 121.768 62.3388 939919 5.85458e+06 -gcp 159.176 59.4895 1.04187e+06 5.86207e+06 -gcp 278.468 31.1886 1.36162e+06 5.95546e+06 -gcp 345.883 105.598 1.54342e+06 5.71734e+06 -gcp 442.397 289.576 1.79865e+06 5.14557e+06 -gcp 538.345 375.324 2.06101e+06 4.88463e+06 -gcp 532.353 393.082 2.04176e+06 4.83829e+06 -gcp 437.571 484.341 1.78867e+06 4.57094e+06 -gcp 398.609 548.242 1.68387e+06 4.39342e+06 -gcp 290.241 481.933 1.39085e+06 4.57736e+06 -gcp 130.919 438.194 968080 4.70783e+06 -gcp 117.074 327.493 925304 5.02936e+06 -gcp 153.93 319.848 1.03011e+06 5.04861e+06 "$DIR/allertaOggiEdit.jpg" "$DIR/allertaOggiGeo.tif"


echo " allertaOggiEdit.tif --->>>  allertaOggiGeo.tif OK"
gdalwarp -r cubicspline -tps -co COMPRESS=NONE  -tr 470.000000 -768.000000 "$DIR/allertaOggiGeo.tif" "$DIR/allertaOggiConv.tif"

echo "gdalwarp allertaOggiGeo.tif ---->>> allertaOggiConv.tif OK"
gdalinfo $DIR/allertaOggiConv.tif

gdal2tiles.py -z 1-8 $DIR/allertaOggiConv.tif $DIR/AllertaOggiGeo

echo "gdal2tiles success"

echo " script Complete"
cd $DIR/AllertaOggiGeo
rm -f openlayers.html googlemaps.html
echo "file rimossi"
ls -l
cp -fR $DIR/AllertaOggiGeo/* $DIR2/Allerta
echo "copia completata"

